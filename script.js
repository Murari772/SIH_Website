const resources = {
			en: {
				translation: {
					brand: "Nabha",
					welcome: "Welcome to Nabha Telemedicine",
					tagline: "Healthcare at your fingertips",
					videoConsultation: "Video Consultation",
					appointments: "Appointments",
					healthRecords: "Health Records",
					medicines: "Medicines",
					medicineAvailability: "Medicine Availability",
					chatWithBot: "Chat with Health Bot",
					chatbot: "Chat with Doctor Bot",
					bookAppointment: "Book Appointment",
					symptomChecker: "Symptom Checker",
					online: "Online",
					send: "Send",
					emergency: "Emergency",
					botGreeting: "Hello! I'm your health assistant. How can I help you today?"
				}
			},
			hi: {
				translation: {
					brand: "नाभा",
					welcome: "नाभा टेलीमेडिसिन में आपका स्वागत है",
					tagline: "स्वास्थ्य सेवाएँ आपके हाथों में",
					videoConsultation: "वीडियो परामर्श",
					appointments: "नियुक्तियाँ",
					healthRecords: "स्वास्थ्य रिकॉर्ड",
					medicines: "दवाइयाँ",
					medicineAvailability: "दवा उपलब्धता",
					chatWithBot: "हेल्थ बॉट से बात करें",
					chatbot: "डॉक्टर बॉट से बात करें",
					bookAppointment: "अपॉइंटमेंट बुक करें",
					symptomChecker: "लक्षण चेकर",
					online: "ऑनलाइन",
					send: "भेजें",
					emergency: "आपातकाल",
					botGreeting: "नमस्ते! मैं आपका स्वास्थ्य सहायक हूँ। आज मैं आपकी कैसे मदद कर सकता हूँ?"
				}
			},
			pa: {
				translation: {
					brand: "ਨਾਭਾ",
					welcome: "ਨਾਭਾ ਟੈਲੀਮੇਡਿਸਿਨ ਵਿੱਚ ਤੁਹਾਡਾ ਸਵਾਗਤ ਹੈ",
					tagline: "ਸਿਹਤ ਸੇਵਾਵਾਂ ਤੁਹਾਡੇ ਹੱਥਾਂ ਵਿੱਚ",
					videoConsultation: "ਵੀਡੀਓ ਸਲਾ੍ਹ",
					appointments: "ਮੁਲਾਕਾਤਾਂ",
					healthRecords: "ਸਿਹਤ ਰਿਕਾਰਡ",
					medicines: "ਦਵਾਈਆਂ",
					medicineAvailability: "ਦਵਾਈ ਉਪਲਬਧਤਾ",
					chatWithBot: "ਹੈਲਥ ਬੌਟ ਨਾਲ ਗੱਲ ਕਰੋ",
					chatbot: "ਡਾਕਟਰ ਬੌਟ ਨਾਲ ਗੱਲ ਕਰੋ",
					bookAppointment: "ਮੁਲਾਕਾਤ ਬੁੱਕ ਕਰੋ",
					symptomChecker: "ਲੱਛਣ ਚੈਕਰ",
					online: "ਆਨਲਾਈਨ",
					send: "ਭੇਜੋ",
					emergency: "ਐਮਰਜੈਂਸੀ",
					botGreeting: "ਸਤ ਸ੍ਰੀ ਅਕਾਲ! ਮੈਂ ਤੁਹਾਡਾ ਸਿਹਤ ਸਹਾਇਕ ਹਾਂ। ਮੈਂ ਕਿਵੇਂ ਮਦਦ ਕਰ ਸਕਦਾ ਹਾਂ?"
				}
			},

            bn: {
            translation: {
                brand: "Nabha",
                welcome: "নাভা টেলিমেডিসিনে স্বাগতম",
                tagline: "স্বাস্থ্যসেবা এখন আপনার হাতের নাগালে",
                videoConsultation: "ভিডিও পরামর্শ",
                appointments: "অ্যাপয়েন্টমেন্ট",
                healthRecords: "স্বাস্থ্য রেকর্ড",
                medicines: "ঔষধ",
                medicineAvailability: "ঔষধের প্রাপ্যতা",
                chatWithBot: "হেলথ বটের সাথে চ্যাট করুন",
                chatbot: "ডাক্তার বটের সাথে চ্যাট করুন",
                bookAppointment: "অ্যাপয়েন্টমেন্ট বুক করুন",
                symptomChecker: "লক্ষণ পরীক্ষক",
                online: "অনলাইন",
                send: "পাঠান",
                emergency: "জরুরি অবস্থা",
                botGreeting: "হ্যালো! আমি আপনার স্বাস্থ্য সহকারী। আজ আমি কীভাবে সাহায্য করতে পারি?"
                }
            },

            ta:{
            translation: {
                brand: "Nabha",
                welcome: "நாபா தொலைமருத்துவத்திற்கு வரவேற்கிறோம்",
                tagline: "சுகாதாரம் உங்கள் விரல்நுனியில்",
                videoConsultation: "வீடியோ ஆலோசனை",
                appointments: "நியமனங்கள்",
                healthRecords: "சுகாதார பதிவுகள்",
                medicines: "மருந்துகள்",
                medicineAvailability: "மருந்து கிடைக்கும் நிலை",
                chatWithBot: "ஹெல்த் போட்டுடன் உரையாடவும்",
                chatbot: "டாக்டர் போட்டுடன் உரையாடவும்",
                bookAppointment: "நியமனம் பதிவு செய்யவும்",
                symptomChecker: "அறிகுறி சரிபார்ப்பான்",
                online: "ஆன்லைன்",
                send: "அனுப்பு",
                emergency: "அவசரம்",
                botGreeting: "வணக்கம்! நான் உங்கள் சுகாதார உதவியாளர். எப்படி உதவலாம்?"
                }
            },

            mr:{
            translation: {
                brand: "Nabha",
                welcome: "नाभा टेलीमेडिसिनमध्ये आपले स्वागत आहे",
                tagline: "आरोग्यसेवा तुमच्या बोटांच्या टोकावर",
                videoConsultation: "व्हिडिओ सल्लामसलत",
                appointments: "अपॉइंटमेंट्स",
                healthRecords: "आरोग्य नोंदी",
                medicines: "औषधे",
                medicineAvailability: "औषध उपलब्धता",
                chatWithBot: "हेल्थ बॉटशी चॅट करा",
                chatbot: "डॉक्टर बॉटशी चॅट करा",
                bookAppointment: "अपॉइंटमेंट बुक करा",
                symptomChecker: "लक्षण तपासक",
                online: "ऑनलाइन",
                send: "पाठवा",
                emergency: "आपत्कालीन",
                botGreeting: "नमस्कार! मी तुमचा आरोग्य सहाय्यक आहे. आज मी कशी मदत करू?"
                }
            },
            
            gu :{
            translation: {
                brand: "Nabha",
                welcome: "નાભા ટેલિમેડિસિનમાં આપનું સ્વાગત છે",
                tagline: "આરોગ્ય સેવાઓ હવે તમારી આંગળીના ટેરવે",
                videoConsultation: "વિડિયો સલાહ",
                appointments: "નિયુક્તિઓ",
                healthRecords: "આરોગ્ય રેકોર્ડ",
                medicines: "દવાઓ",
                medicineAvailability: "દવાઓની ઉપલબ્ધતા",
                chatWithBot: "હેલ્થ બોટ સાથે વાત કરો",
                chatbot: "ડૉક્ટર બોટ સાથે વાત કરો",
                bookAppointment: "નિયુક્તિ બુક કરો",
                symptomChecker: "લક્ષણ ચેકર",
                online: "ઓનલાઇન",
                send: "મોકલો",
                emergency: "તાત્કાલિક",
                botGreeting: "નમસ્તે! હું તમારો આરોગ્ય સહાયક છું. આજે હું કેવી રીતે મદદ કરી શકું?"
                }
            },

            te:{
            translation: {
                brand: "Nabha",
                welcome: "నాభా టెలిమెడిసిన్‌కి స్వాగతం",
                tagline: "ఆరోగ్య సేవలు మీ చేతుల వెంటనే",
                videoConsultation: "వీడియో సంప్రదింపు",
                appointments: "అపాయింట్‌మెంట్లు",
                healthRecords: "ఆరోగ్య రికార్డులు",
                medicines: "మందులు",
                medicineAvailability: "మందుల లభ్యత",
                chatWithBot: "హెల్త్ బాట్‌తో చాట్ చేయండి",
                chatbot: "డాక్టర్ బాట్‌తో చాట్ చేయండి",
                bookAppointment: "అపాయింట్‌మెంట్ బుక్ చేయండి",
                symptomChecker: "లక్షణ చెకర్",
                online: "ఆన్‌లైన్",
                send: "పంపండి",
                emergency: "అత్యవసరం",
                botGreeting: "హలో! నేను మీ ఆరోగ్య సహాయకుడు. ఈరోజు మీకు ఎలా సహాయం చేయగలను?"
                }
            },

            kn:{
            translation: {
                brand: "Nabha",
                welcome: "ನಾಭಾ ಟೆಲಿಮೆಡಿಸಿನ್‌ಗೆ ಸ್ವಾಗತ",
                tagline: "ಆರೋಗ್ಯ ಸೇವೆಗಳು ನಿಮ್ಮ ಬೆರಳ ತುದಿಯಲ್ಲಿ",
                videoConsultation: "ವೀಡಿಯೋ ಸಲಹೆ",
                appointments: "ನೇಮಕಾತಿಗಳು",
                healthRecords: "ಆರೋಗ್ಯ ದಾಖಲೆಗಳು",
                medicines: "ಔಷಧಗಳು",
                medicineAvailability: "ಔಷಧ ಲಭ್ಯತೆ",
                chatWithBot: "ಹೆಲ್ತ್ ಬಾಟ್ ಜೊತೆ ಮಾತನಾಡಿ",
                chatbot: "ಡಾಕ್ಟರ್ ಬಾಟ್ ಜೊತೆ ಮಾತನಾಡಿ",
                bookAppointment: "ನೇಮಕಾತಿ ಬುಕ್ ಮಾಡಿ",
                symptomChecker: "ಲಕ್ಷಣ ಪರಿಶೀಲಕ",
                online: "ಆನ್‌ಲೈನ್",
                send: "ಕಳುಹಿಸಿ",
                emergency: "ತುರ್ತು",
                botGreeting: "ನಮಸ್ಕಾರ! ನಾನು ನಿಮ್ಮ ಆರೋಗ್ಯ ಸಹಾಯಕ. ಇಂದು ನಾನು ಹೇಗೆ ಸಹಾಯ ಮಾಡಲಿ?"
                }
            },

            ur:{
            translation: {
                brand: "Nabha",
                welcome: "نابھا ٹیلی میڈیسن میں خوش آمدید",
                tagline: "صحت کی سہولیات آپ کی دسترس میں",
                videoConsultation: "ویڈیو مشاورت",
                appointments: "اپائنٹمنٹس",
                healthRecords: "صحت کے ریکارڈ",
                medicines: "ادویات",
                medicineAvailability: "ادویات کی دستیابی",
                chatWithBot: "ہیلتھ بوٹ سے بات کریں",
                chatbot: "ڈاکٹر بوٹ سے بات کریں",
                bookAppointment: "اپائنٹمنٹ بُک کریں",
                symptomChecker: "علامات چیکر",
                online: "آن لائن",
                send: "بھیجیں",
                emergency: "ایمرجنسی",
                botGreeting: "سلام! میں آپ کا صحت معاون ہوں۔ آج میں کیسے مدد کر سکتا ہوں؟"
                }
            },

            ml:{
            translation: {
                brand: "Nabha",
                welcome: "നാഭ ടെലിമെഡിസിനിലേക്ക് സ്വാഗതം",
                tagline: "ആരോഗ്യം നിങ്ങളുടെ വിരൽത്തുമ്പിൽ",
                videoConsultation: "വീഡിയോ കൗൺസലിംഗ്",
                appointments: "അപ്പോയിന്റ്മെന്റുകൾ",
                healthRecords: "ആരോഗ്യ രേഖകൾ",
                medicines: "മരുന്നുകൾ",
                medicineAvailability: "മരുന്നുകളുടെ ലഭ്യത",
                chatWithBot: "ഹെൽത്ത് ബോട്ടുമായി ചാറ്റ് ചെയ്യൂ",
                chatbot: "ഡോക്ടർ ബോട്ടുമായി ചാറ്റ് ചെയ്യൂ",
                bookAppointment: "അപ്പോയിന്റ്മെന്റ് ബുക്ക് ചെയ്യൂ",
                symptomChecker: "ലക്ഷണ പരിശോധന",
                online: "ഓൺലൈൻ",
                send: "അയക്കുക",
                emergency: "ആപത്ത്",
                botGreeting: "നമസ്കാരം! ഞാൻ നിങ്ങളുടെ ആരോഗ്യ സഹായി. ഇന്ന് എങ്ങനെ സഹായിക്കാം?"
                }
            }

                        
		};

		i18next
			.use(i18nextBrowserLanguageDetector)
			.init({
				resources,
				fallbackLng: "en",
				detection: { order: ["localStorage","navigator","htmlTag"], caches: ["localStorage"] }
			}, () => updateTexts());

		function updateTexts() {
			document.querySelectorAll("[data-i18n]").forEach(el => {
				const key = el.getAttribute("data-i18n");
				el.textContent = i18next.t(key);
			});
			const input = document.getElementById("chatInput");
			if (input) input.placeholder = i18next.t("botGreeting");
		}

		document.getElementById("langSelect").value = i18next.language || "en";
		document.getElementById("langSelect").addEventListener("change", (e) => {
			i18next.changeLanguage(e.target.value, updateTexts);
			localStorage.setItem("language", e.target.value);
		});

		document.getElementById("year").textContent = new Date().getFullYear();

		// Chat widget behavior
		const chatPanel = document.getElementById("chatPanel");
		const floatingBtn = document.getElementById("floatingChatBtn");
		const headerBtn = document.getElementById("openChatBtn");
		const closeBtn = document.getElementById("closeChatBtn");
		const sendBtn = document.getElementById("sendBtn");
		const input = document.getElementById("chatInput");
		const list = document.getElementById("chatMessages");

		function openChat() {
			chatPanel.style.display = "flex";
			input.focus();
		}
		function closeChat() {
			chatPanel.style.display = "none";
		}
		floatingBtn.addEventListener("click", openChat);
		if (headerBtn) headerBtn.addEventListener("click", openChat);
		closeBtn.addEventListener("click", closeChat);

		// Quick actions
		document.querySelectorAll("[data-quick]").forEach(btn => {
			btn.addEventListener("click", () => {
				const action = btn.getAttribute("data-quick");
				let text = "";
				if (action === "emergency") text = i18next.t("emergency");
				if (action === "video") text = i18next.t("videoConsultation");
				if (action === "appointment") text = i18next.t("bookAppointment");
				if (action === "symptoms") text = i18next.t("symptomChecker");
				input.value = text;
				input.focus();
			});
		});

		function appendMessage(text, who) {
			const div = document.createElement("div");
			div.className = who === "user" ? "bubble-user text-sm" : "bubble-bot text-sm";
			div.textContent = text;
			const wrapper = document.createElement("div");
			wrapper.className = "flex";
			wrapper.style.justifyContent = who === "user" ? "flex-end" : "flex-start";
			wrapper.appendChild(div);
			list.appendChild(wrapper);
			list.scrollTop = list.scrollHeight;
		}

		function botReply(userText) {
			// Very simple, offline bot rules (placeholder)
			const lower = userText.toLowerCase();
			if (lower.includes("emergency")) return "If this is an emergency, please dial 108 immediately.";
			if (lower.includes("fever")) return "For fever, stay hydrated and rest. If persists >48h, consult a doctor.";
			if (lower.includes("appointment")) return "You can book an appointment from the Appointments section.";
			if (lower.includes("video")) return "Video consultations are available 9am–5pm. Please pick a slot.";
			if (lower.includes("medicine")) return "Check the Medicines section for availability at nearby pharmacies.";
			if (lower.includes("hello") || lower.includes("hi")) return i18next.t("botGreeting");
			return "Thanks! I’ve noted your query. A doctor will review if needed.";
		}

		function sendMessage() {
			const text = (input.value || "").trim();
			if (!text) return;
			appendMessage(text, "user");
			input.value = "";
			setTimeout(() => {
				appendMessage(botReply(text), "bot");
			}, 700);
		}
        document.getElementById("openChatBtn").cursor = "pointer";

		sendBtn.addEventListener("click", sendMessage);
		input.addEventListener("keydown", (e) => {
			if (e.key === "Enter" && !e.shiftKey) {
				e.preventDefault();
				sendMessage();
			}
		});